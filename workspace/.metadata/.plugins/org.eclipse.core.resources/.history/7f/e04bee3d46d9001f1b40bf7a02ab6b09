<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">

<!-- 관리자 로그인 쿼리 -->
<mapper namespace="Admin">
	<select id="login" parameterType="map" resultType="AdminDTO">
		SELECT
		admin_number, admin_id, admin_passwd
		FROM tbl_admin
		WHERE admin_id =
		#{id} AND admin_passwd = #{pw}
	</select>

	<!-- 전체 회원 조회 -->
	<select id="adminUser" resultType="UserDTO">
		SELECT user_number,
		user_nickname, user_tier, user_phone, user_join_date, user_ben_cnt
		FROM tbl_user
	</select>

	<!-- 전체 회원 수 조회 -->
	<select id="totalUserCount" resultType="int">
		SELECT count(*) FROM
		tbl_user
	</select>

	<!-- 파티 게시글 목록 조회 -->
	<select id="adminParty" resultType="AdminPartyDTO">
		SELECT f.forum_number,
		f.forum_category, f.forum_title, f.forum_date,
		u.user_nickname,
		u.user_tier
		FROM tbl_forum f INNER JOIN tbl_user u
		ON f.user_number =
		u.user_number
		WHERE f.forum_category LIKE '%모집%'
	</select>
	<!-- 전체 파티 게시글 수 -->
	<select id="totalPartyForumCount" resultType="int">
		SELECT count(*)
		FROM tbl_forum
		WHERE forum_category LIKE '%모집%'
	</select>

	<select id="postCount" parameterType="int" resultType="int">
		SELECT count(*) FROM TBL_FORUM WHERE TO_CHAR(FORUM_DATE,'YYYY-MM-DD') =
		TO_CHAR(SYSDATE-#{day},'YYYY-MM-DD')
	</select>


	<select id="tierCount" parameterType="String" resultType="int">
		SELECT COUNT(USER_TIER) count FROM TBL_USER WHERE USER_TIER = #{tier}
	</select>


	<select id="categoryCount" parameterType="String"
		resultType="int">
		SELECT COUNT(FORUM_CATEGORY) count FROM TBL_FORUM WHERE FORUM_CATEGORY = #{category}
	</select>
	
	<select id="searchUser" parameterType="String" resultType="UserDTO">
		select user_number, user_nickname, user_tier, user_phone, user_join_date, user_ben_cnt
		from tbl_user
		where user_nickname like '%'||#{userNickname}||'%'
		order by user_number
	</select>
</mapper>